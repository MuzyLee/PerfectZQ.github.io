---
layout: post
title: Spark读取csv文件
tag: Spark
---

### 读取csv文件
```
val sparkSession = SparkSession.builder.getOrCreate
val data = sparkSession
            .read
            // csv文件的第一行为列名，默认值是false
            .option("header", true)
            // csv文件的分割符，默认是英文的逗号，只能是一个字符
            .option("delimiter","|")
            // 指定要过滤掉的引号，默认是英文的双引号
            .option("quote","'")
            // 解析的模式。默认值是PERMISSIVE，支持的选项有
            //（1）PERMISSIVE：尝试解析所有的行，nulls are inserted for missing tokens and extra tokens are ignored.
            //（2）DROPMALFORMED：drops lines which have fewer or more tokens than expected
            //（3）FAILFAST: aborts with a RuntimeException if encounters any malformed line
            .option("mode","DROPMALFORMED")
            .csv("""hdfs:///data-zhangqiang/homeVisit.csv""")
                              
```
    